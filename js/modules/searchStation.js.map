{"version":3,"names":[],"mappings":"","sources":["modules/searchStation.js"],"sourcesContent":["import GetAuthorizationHeader from \"getAurthor.js\";\r\nimport showSearchResult from \"showSearchResult.js\";\r\n\r\nexport default function searchStation(map, layerGroup) {\r\n  const city = document.querySelector('#citySelector').value;\r\n  const keyword = document.querySelector('#searchKeyword').value;\r\n\r\n  if (!city) {\r\n    alert('請選擇區域');\r\n    return;\r\n  }\r\n\r\n  axios({\r\n    method: 'get',\r\n    baseURL: 'https://ptx.transportdata.tw/MOTC/',\r\n    url: `v2/Bike/Station/${city}?$format=JSON`,\r\n    headers: GetAuthorizationHeader()    \r\n  })\r\n    .then(res => {\r\n      const stationData = res.data;\r\n      const stationInSearch = [];\r\n\r\n      if (!keyword) {\r\n        showSearchResult(stationData, map, layerGroup);\r\n      } else {\r\n        stationData.forEach(station => {\r\n          let id = station.StationID;\r\n          let name = station.StationName.Zh_tw;\r\n          let address = station.StationAddress.Zh_tw;\r\n          const key = new RegExp(keyword);\r\n          \r\n          if (key.test(id) || key.test(name) || key.test(address)) {\r\n            stationInSearch.push(station);\r\n          }\r\n\r\n        })\r\n        showSearchResult(stationInSearch, map, layerGroup);\r\n      }\r\n\r\n\r\n    })\r\n    .catch(err => console.log(err));\r\n}"],"file":"searchStation.js"}